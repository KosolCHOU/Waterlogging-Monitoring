{% extends "base.html" %}
{% block title %}Create account ‚Äì CropXcel{% endblock %}

{% block head %}
<style>
/* Page shell */
.login-wrap {
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(180deg,#f8fafc 0%,#f1f5f9 100%);
}

/* Card: scrollable inside */
.auth-card{
  width:min(560px,92vw);
  max-height:90vh;
  overflow-y:auto;
  background:#fff;
  border-radius:20px;
  box-shadow:0 20px 50px rgba(0,0,0,.10);
  padding:28px 24px;
  position:relative;
}
.auth-card details summary{
  color:#ffffff;
  font-weight:700;
  cursor:pointer;
}
@media (prefers-color-scheme: dark){
  .auth-card details summary{ color:#e2e8f0; }
}

.auth-card::-webkit-scrollbar{ width:8px; }
.auth-card::-webkit-scrollbar-thumb{ background:#cbd5e1; border-radius:999px; }

/* Ribbon */
.ribbon{position:absolute; inset:auto -20% auto -20%; top:-140px; height:220px;
  background:linear-gradient(90deg,#22c55e 0%,#16a34a 50%,#0ea5e9 100%);
  filter:blur(40px); opacity:.12; transform:rotate(-6deg); pointer-events:none}

/* Headings */
.title{font-weight:800; font-size:1.6rem; color:#0f172a; margin:6px 0 4px; text-align:center}
.subtitle{color:#334155; margin:0 0 16px; line-height:1.45; text-align:center}
.welcome-msg{background:#ecfdf5; color:#065f46; padding:10px 14px; border-radius:12px;
             font-size:.95rem; font-weight:600; margin-bottom:16px; text-align:center}

/* Fields ‚Äì identical to login */
.form-grid{display:block; gap:12px; margin-top:6px; max-width:420px; width:100%; margin:0 auto;}
.field label{font-weight:700; color:#0f172a; display:block; margin-bottom:6px}
.input-wrap{position:relative; width:100%;}
.auth-card input, .auth-card select{
  border:1px solid #cbd5e1; padding:12px 14px;
  width:100%; border-radius:12px; box-sizing:border-box;
  font-size:1rem; color:#0f172a;
}
.auth-card input:focus, .auth-card select:focus{
  border-color:#0ea5e9; box-shadow:0 0 0 4px rgba(14,165,233,.15)
}
.toggle-eye{position:absolute; right:10px; top:50%; transform:translateY(-50%);
  background:none; border:0; cursor:pointer; font-size:.95rem}

/* Hints & errors */
.hint{font-size:.9rem; color:#64748b; margin-top:6px}
.field-error{color:#b91c1c; font-size:.9rem; margin-top:6px}

/* Equal widths for inputs & button */
.input-wrap input,
.cta .btn-primary { width:100%; max-width:100%; display:block; border-radius:12px; }

/* CTA */
.cta{margin-top:14px; max-width:420px; margin:14px auto 0; display:block;}
.btn{appearance:none; border:0; outline:0; cursor:pointer;
  display:inline-flex; align-items:center; justify-content:center;
  gap:8px; padding:12px 16px; border-radius:12px; font-weight:800;
  text-decoration:none; transition:transform .05s ease, box-shadow .2s ease, background .2s ease, color .2s ease;}
.btn:active{transform:translateY(1px)}
.btn-primary{color:#fff; background:linear-gradient(180deg,#0ea5e9,#0284c7); box-shadow:0 8px 20px rgba(2,132,199,.35)}
.btn-primary:hover{box-shadow:0 10px 26px rgba(2,132,199,.45)}

/* Help link */
.help{margin-top:12px; font-size:.95rem; color:#475569; text-align:center}
.help a{color:#0284c7; text-decoration:none; font-weight:700}
.help a:hover{text-decoration:underline}

/* Dark mode parity */
@media (prefers-color-scheme: dark){
  .login-wrap{background:linear-gradient(180deg,#0b1220 0%,#0b1020 100%)}
  .auth-card{background:#0f172a; box-shadow:0 20px 50px rgba(0,0,0,.5)}
  .title{color:#e2e8f0} .subtitle{color:#cbd5e1}
  .auth-card input,.auth-card select{background:linear-gradient(180deg,#0c1323,#0b1220); border-color:#1f2937; color:#e2e8f0}
  .btn-primary{background:linear-gradient(180deg,#0284c7,#0369a1)}
  .help{color:#cbd5e1} .field label{color:#e2e8f0}
  .welcome-msg{background:#064e3b; color:#a7f3d0}
}
</style>
{% endblock %}

{% block content %}
<div class="login-wrap">
  <form method="post" class="auth-card" novalidate>
    <div class="ribbon"></div>

    <h1 class="title">Create your account</h1>
    <p class="subtitle">It only takes a minute ‚Äî then you‚Äôll get personalized water-risk alerts and tools for your fields.</p>
    <div class="welcome-msg">üå± Welcome! Join CropXcel today and make smarter decisions for healthier, higher-yield rice.</div>

    {% csrf_token %}
    <div class="form-grid">
      <div class="field">
        <label>Username</label>
        <div class="input-wrap">{{ form.username }}</div>
        {% if form.username.errors %}
          <div class="field-error">üå± Please enter a username ‚Äî it‚Äôs required.</div>
        {% endif %}
      </div>

      <div class="field">
        <label>Password</label>
        <div class="input-wrap">
          {{ form.password1 }}
          <button type="button" class="toggle-eye">üëÅÔ∏è</button>
        </div>
        {% if form.password1.errors %}
          <div class="field-error">üîí Password must be at least 8 characters.</div>
        {% endif %}
      </div>

      <div class="field">
        <label>Confirm password</label>
        <div class="input-wrap">
          {{ form.password2 }}
          <button type="button" class="toggle-eye">üëÅÔ∏è</button>
        </div>
        {% if form.password2.errors %}
          <div class="field-error">‚úçÔ∏è Your confirmation doesn‚Äôt match the password.</div>
        {% endif %}
      </div>
    </div>

    <details {% if form.errors %}open{% endif %} style="margin-top:12px">
      <summary>More details (optional)</summary>
      <div class="form-grid" style="margin-top:10px">
        <div class="field"><label>Full name</label>{{ form.full_name }}</div>
        <div class="field"><label>Phone</label>{{ form.phone }}</div>
        <div class="field"><label>Date of birth</label>{{ form.date_of_birth }}</div>
        <div class="field"><label>Main crop</label>{{ form.main_crop }}</div>
        <div class="field"><label>Province</label>{{ form.province }}</div>
      </div>
    </details>

    <div class="cta">
      <button class="btn btn-primary" type="submit">üå± Create account</button>
    </div>

    <div class="help">Already have one? <a href="{% url 'login' %}">Sign in</a></div>
  </form>
</div>

<script>
  // Toggle show/hide password
  document.querySelectorAll('.toggle-eye').forEach(btn=>{
    const input = btn.previousElementSibling;
    btn.addEventListener('click', ()=>{
      const isPwd = input.type === 'password';
      input.type = isPwd ? 'text' : 'password';
      btn.textContent = isPwd ? 'üôà' : 'üëÅÔ∏è';
    });
  });
</script>
{% endblock %}
